---
import Partners from "../../components/Partners.astro";
import Sponsors from "../../components/Sponsors.astro";
import Layout from "../../layouts/Layout.astro";

import {
  ADDRESS,
  BLIND_TICKET_PRICE,
  BLIND_TICKET_SOLD_OUT,
  EVENT_DATE,
  EVENT_END_TIME,
  EVENT_START_TIME,
  HELLOASSO_LINK,
  OPEN_BLIND_TICKET_SALE_DATE,
  OPEN_TICKET_SALE_DATE,
  OPEN_WORKSHOP_TICKET_SALE_DATE,
  PARTENERS,
  SPONSORS,
  TICKETING_TRIGGER_EVENT,
  TICKET_PRICE,
  TICKET_SOLD_OUT,
  WORKSHOP_TICKET_PRICE,
  WORKSHOP_TICKET_SOLD_OUT,
} from "../../consts";
import { displayDate } from "../../utils";
---

<Layout title={EVENT_DATE}>
  <main>
    <!-- Hero Section with Conference Image -->
    <div
      class="hero min-h-[calc(100vh-64px)] relative"
      style="background-image: url('/hero/home-hero.jpg'); background-size: cover; background-position: center;"
    >
      <div class="hero-overlay bg-opacity-80 bg-base-100"></div>
      <div class="hero-content text-center text-base-content px-4 relative">
        <div class="max-w-4xl">
          <img
            class="w-full max-w-sm mx-auto"
            src="/ng-baguette-logo-colorfull-white.png"
            alt="NG Baguette Logo"
          />
          <h1 class="text-4xl md:text-6xl font-bold mb-6 title-font text-white tracking-wide">
            La conférence Angular à la française
          </h1>
          <p class="text-xl md:text-2xl text-white/90 mb-8 max-w-2xl mx-auto">
            Rejoignez-nous pour une expérience unique de conférence Angular en
            France ! Découvrez les dernières nouveautés en développement
            Angular, réseautez avec des experts et d'autres développeurs.
          </p>
          <div class="flex flex-col md:flex-row items-center justify-center gap-4 md:gap-8 mb-8">
            <div class="text-center md:text-left">
              <p class="text-2xl md:text-3xl font-bold text-white">
                {displayDate(EVENT_DATE)}
              </p>
              <p class="text-lg text-white/80">{EVENT_START_TIME} - {EVENT_END_TIME}</p>
            </div>
            <div class="hidden md:block w-px h-12 bg-base-content/30"></div>
            <div class="text-center md:text-left">
              <p class="text-2xl md:text-3xl font-semibold text-white">
                {ADDRESS.addressLocality}
              </p>
              <p class="text-base text-white/70">
                {ADDRESS.addressCountry}
              </p>
            </div>
          </div>
          {TICKETING_TRIGGER_EVENT === 'open' && (
            <a
              href="#tickets"
              class="btn btn-primary btn-lg mt-4 font-bold"
            >
              Obtenez vos billets
            </a>
          )}

          <!-- Newsletter Section -->
          <div class="mt-8">
            <div class="card bg-base-100/70 backdrop-blur-sm shadow-lg max-w-lg mx-auto">
              <div class="card-body p-4">
                <h2 class="text-lg md:text-xl font-bold mb-1 text-white text-center">Ne manquez pas nos actualités !</h2>
                <p class="text-xs text-white/80 text-center mb-0">Inscrivez-vous pour rester informé de la conférence</p>
                <div class="sib-form">
                  <div id="sib-form-container" class="sib-form-container">
                    <div id="error-message" class="sib-form-message-panel">
                      <div class="sib-form-message-panel__text sib-form-message-panel__text--center">
                        <svg viewBox="0 0 512 512" class="sib-icon sib-notification__icon">
                          <path d="M256 40c118.621 0 216 96.075 216 216 0 119.291-96.61 216-216 216-119.244 0-216-96.562-216-216 0-119.203 96.602-216 216-216m0-32C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm-11.49 120h22.979c6.823 0 12.274 5.682 11.99 12.5l-7 168c-.268 6.428-5.556 11.5-11.99 11.5h-8.979c-6.433 0-11.722-5.073-11.99-11.5l-7-168c-.283-6.818 5.167-12.5 11.99-12.5zM256 340c-15.464 0-28 12.536-28 28s12.536 28 28 28 28-12.536 28-28-12.536-28-28-28z" />
                        </svg>
                        <span class="sib-form-message-panel__inner-text">
                          Nous n&#039;avons pas pu confirmer votre inscription.
                        </span>
                      </div>
                    </div>
                    <div></div>
                    <div id="success-message" class="sib-form-message-panel">
                      <div class="sib-form-message-panel__text sib-form-message-panel__text--center">
                        <svg viewBox="0 0 512 512" class="sib-icon sib-notification__icon">
                          <path d="M256 8C119.033 8 8 119.033 8 256s111.033 248 248 248 248-111.033 248-248S392.967 8 256 8zm0 464c-118.664 0-216-96.055-216-216 0-118.663 96.055-216 216-216 118.664 0 216 96.055 216 216 0 118.663-96.055 216-216 216zm141.63-274.961L217.15 376.071c-4.705 4.667-12.303 4.637-16.97-.068l-85.878-86.572c-4.667-4.705-4.637-12.303.068-16.97l8.52-8.451c4.705-4.667 12.303-4.637 16.97.068l68.976 69.533 163.441-162.13c4.705-4.667 12.303-4.637 16.97.068l8.451 8.52c4.668 4.705 4.637 12.303-.068 16.97z" />
                        </svg>
                        <span class="sib-form-message-panel__inner-text">
                          Un mail de validation sera envoyé, vérifiez vos spams !
                        </span>
                      </div>
                    </div>
                    <div></div>
                    <div id="sib-container" class="sib-container--large sib-container--vertical">
                      <form id="sib-form" method="POST" action="https://ce61d189.sibforms.com/serve/MUIFAG64q-W7YU2YDjfbFFOXjbs1hqvqlze8oIGMDLOdpjPKleNprY4AQIu72OCYj4nFq1suFGw9VusLNlnwcNNCIsbIBEpw2zYSK9lPvDP1nr287Vq-pqgOG4hvt3VfeoFeenqHUsT5oqmgPB-U3vJq6xsxDih-j8Ec-po_oAOaVH7nmaWPnxr0NEeRKmW1uMI3zN1nBwxbPCf97g==" data-type="subscription">
                        <div style="padding: 8px 0;">
                          <div class="sib-form-block">
                            <div class="sib-text-form-block">
                              <p class="hidden">Newsletter</p>
                            </div>
                          </div>
                        </div>
                        <div style="padding: 8px 0;">
                          <div class="sib-form-block">
                            <div class="sib-text-form-block">
                              <p class="hidden">Inscrivez-vous à notre newsletter pour suivre nos actualités.</p>
                            </div>
                          </div>
                        </div>
                        <div style="padding: 8px 0;">
                          <div class="sib-input sib-form-block">
                            <div class="form__entry entry_block">
                              <div class="form__label-row">
                                <div class="entry__field">
                                  <input class="input input-bordered w-full" type="text" id="EMAIL" name="EMAIL" autocomplete="off" placeholder="EMAIL" data-required="true" required />
                                </div>
                              </div>
                              <label class="entry__error entry__error--primary"></label>
                            </div>
                          </div>
                        </div>
                        <div>
                          <div class="sib-form-block">
                            <button class="sib-form-block__button sib-form-block__button-with-loader btn btn-primary w-full md:w-auto whitespace-nowrap font-bold" form="sib-form" type="submit">
                              <svg class="icon clickable__icon progress-indicator__icon sib-hide-loader-icon" viewBox="0 0 512 512" style="">
                                <path d="M460.116 373.846l-20.823-12.022c-5.541-3.199-7.54-10.159-4.663-15.874 30.137-59.886 28.343-131.652-5.386-189.946-33.641-58.394-94.896-95.833-161.827-99.676C261.028 55.961 256 50.751 256 44.352V20.309c0-6.904 5.808-12.337 12.703-11.982 83.556 4.306 160.163 50.864 202.11 123.677 42.063 72.696 44.079 162.316 6.031 236.832-3.14 6.148-10.75 8.461-16.728 5.01z" />
                              </svg>
                              S&#039;INSCRIRE
                            </button>
                          </div>
                        </div>
                        <input type="text" name="email_address_check" value="" class="input--hidden">
                        <input type="hidden" name="locale" value="fr">
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Content Section -->
    <section class="max-w-7xl mx-auto px-4 md:px-8 py-16">
      <!-- Tickets Section -->
      <div id="tickets" class="mb-16 scroll-mt-20">
        <h2 class="text-3xl md:text-4xl font-bold mb-8 text-center">Obtenez vos billets</h2>
        
        {TICKETING_TRIGGER_EVENT === 'open' && (
          <ul class="flex flex-col md:flex-row gap-6 items-stretch max-w-5xl mx-auto">
                <li
                  class="flex-1 card bg-base-200 shadow-lg border border-base-300/50 hover:border-base-300 transition-colors"
                >
                  <div class="card-body flex flex-col items-center py-8">
                    <h3 class="card-title text-xl text-center mb-1">Billet blind</h3>
                    <p class="text-sm text-base-content/60 mb-4">Quantité limitée</p>

                    <span class="text-4xl font-bold mb-6">€{BLIND_TICKET_PRICE}</span>

                    {
                      new Date() >= new Date(OPEN_BLIND_TICKET_SALE_DATE) ? (
                        BLIND_TICKET_SOLD_OUT ? (
                          <p class="text-base-content/60 text-sm">Complet</p>
                        ) : (
                          <button
                            class="btn btn-primary w-full"
                            onclick="document.getElementById('ticket-modal').showModal()"
                          >
                            Obtenir votre billet
                          </button>
                        )
                      ) : (
                        <p class="text-base-content/60 text-sm text-center">
                          Pas encore en vente à partir du
                          {displayDate(OPEN_BLIND_TICKET_SALE_DATE)})
                        </p>
                      )
                    }
                    <dialog id="ticket-modal" class="modal">
                      <div class="modal-box">
                        <h3 class="font-bold text-lg">Note importante</h3>
                        <p class="py-4">
                          Pour réduire les coûts et simplifier cette première édition, nous utilisons
                          une plateforme française gratuite dédiée aux événements à but non lucratif.
                        </p>
                        <p>La page d'inscription des billets est en français.</p>
                        <p>
                          Si votre vocabulaire français se limite à "Oui Oui
                          Baguette", vous pouvez utiliser Google Traduction pour
                          compléter votre achat !
                        </p>
                        <div class="modal-action">
                          <form class="flex gap-4" method="dialog">
                            <a
                              href={HELLOASSO_LINK}
                              target="_blank"
                              class="btn btn-primary">Obtenir votre billet</a
                            >
                            <button class="btn">Fermer</button>
                          </form>
                        </div>
                      </div>
                    </dialog>
                  </div>
                </li>
                <li
                  class="flex-1 card bg-base-200 shadow-lg border border-base-300/50 hover:border-base-300 transition-colors"
                >
                  <div class="card-body flex flex-col items-center py-8">
                    <h3 class="card-title text-xl text-center mb-1">
                      Billet Standard
                    </h3>
                    <p class="text-sm text-base-content/60 mb-4">Billet conférence classique</p>
                    <span class="text-4xl font-bold mb-6">€{TICKET_PRICE}</span>
                    {
                      new Date() >= new Date(OPEN_TICKET_SALE_DATE) ? (
                        TICKET_SOLD_OUT ? (
                          <p class="text-base-content/60 text-sm">Complet</p>
                        ) : (
                          <button
                            class="btn btn-primary w-full"
                            onclick="document.getElementById('ticket-modal').showModal()"
                          >
                            Obtenir votre billet
                          </button>
                        )
                      ) : (
                        <p class="text-base-content/60 text-sm text-center">
                          Pas encore en vente à partir du
                          {displayDate(OPEN_TICKET_SALE_DATE)})
                        </p>
                      )
                    }
                  </div>
                </li>
                <li
                  class="flex-1 card bg-base-200 shadow-lg border border-base-300/50 hover:border-base-300 transition-colors"
                >
                  <div class="card-body flex flex-col items-center py-8">
                    <h3 class="card-title text-xl text-center mb-1">Billet Workshop</h3>
                    <p class="text-sm text-base-content/60 mb-4">Conférence + Workshop</p>
                    <span class="text-4xl font-bold mb-6">€{WORKSHOP_TICKET_PRICE}</span>
                    {
                      new Date() >= new Date(OPEN_WORKSHOP_TICKET_SALE_DATE) ? (
                        WORKSHOP_TICKET_SOLD_OUT ? (
                          <p class="text-base-content/60 text-sm">Complet</p>
                        ) : (
                          <button
                            class="btn btn-primary w-full"
                            onclick="document.getElementById('ticket-modal').showModal()"
                          >
                            Obtenir votre billet
                          </button>
                        )
                      ) : (
                        <p class="text-base-content/60 text-sm text-center">
                          Pas encore en vente à partir du
                          {displayDate(OPEN_WORKSHOP_TICKET_SALE_DATE)})
                        </p>
                      )
                    }
                  </div>
                </li>
          </ul>
        )}

        {TICKETING_TRIGGER_EVENT === 'awaiting' && (
          <div class="max-w-2xl mx-auto text-center">
            <p class="text-xl text-base-content/80 mb-4">
              La vente de billets ouvrira bientôt ! Restez à l'écoute pour les mises à jour.
            </p>
          </div>
        )}

        {TICKETING_TRIGGER_EVENT === 'closed' && (
          <div class="max-w-2xl mx-auto text-center">
            <p class="text-xl text-base-content/80 mb-4">
              La vente de billets est maintenant fermée.
            </p>
            <p class="text-base text-base-content/60">
              Merci pour votre intérêt ! Si vous avez des questions, n'hésitez pas à nous contacter.
            </p>
          </div>
        )}
      </div>

      <!-- Sponsors Section -->
      {SPONSORS.length > 0 && (
        <div class="mb-16">
          <h2 class="text-3xl md:text-4xl font-bold mb-8 text-center">Nos Sponsors</h2>
          <Sponsors />
        </div>
      )}

      <!-- Partners Section -->
      {PARTENERS.length > 0 && (
        <div class="mb-16">
          <h2 class="text-3xl md:text-4xl font-bold mb-8 text-center">Nos Partenaires</h2>
          <Partners />
        </div>
      )}
    </section>
  </main>
</Layout>

<style>
  .title-font {
    font-family: "Bangers", sans-serif;
  }
  
  /* Brevo Form Custom Styles */
  .sib-form {
    text-align: center;
    margin-top: -0.5rem;
  }
  
  #sib-container {
    background-color: transparent;
    max-width: 100%;
    margin: 0;
    border-radius: 0;
    border: none;
    padding: 0;
    direction: ltr;
  }
  
  #sib-container .sib-form-block {
    margin: 0;
  }
  
  #sib-form-container {
    margin-top: 0;
  }
  
  #sib-container form > div[style*="padding: 8px 0"]:first-child,
  #sib-container form > div[style*="padding: 8px 0"]:nth-child(2) {
    display: none;
  }
  
  #sib-container form > div[style*="padding: 8px 0"]:nth-child(3) {
    flex: 1;
    padding: 0 !important;
  }
  
  #sib-container form > div[style*="padding: 8px 0"]:last-child {
    padding: 0 !important;
  }
  
  #sib-container form {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
  }
  
  @media (min-width: 768px) {
    #sib-container form {
      flex-direction: row;
    }
  }
  
  #sib-container .entry__field input {
    background-color: hsl(var(--b1));
    border-color: hsl(var(--b3));
    color: #000000;
  }
  
  #sib-container .entry__field input:focus {
    color: #000000;
  }
  
  #sib-container .entry__field input::placeholder {
    color: hsl(var(--bc) / 0.5);
  }
  
  #error-message.sib-form-message-panel {
    font-size: 0.875rem;
    text-align: center;
    color: #fff;
    background-color: rgba(239, 68, 68, 0.2);
    border-radius: 0.5rem;
    border: 1px solid rgba(239, 68, 68, 0.5);
    max-width: 540px;
    margin: 0 auto 1rem;
    padding: 1rem;
  }
  
  #error-message .sib-icon {
    width: 1.25rem;
    height: 1.25rem;
    fill: currentColor;
    margin-right: 0.5rem;
    vertical-align: middle;
  }
  
  #success-message.sib-form-message-panel {
    font-size: 0.875rem;
    text-align: center;
    color: #fff;
    background-color: rgba(34, 197, 94, 0.2);
    border-radius: 0.5rem;
    border: 1px solid rgba(34, 197, 94, 0.5);
    max-width: 540px;
    margin: 0 auto 1rem;
    padding: 1rem;
  }
  
  #success-message .sib-icon {
    width: 1.25rem;
    height: 1.25rem;
    fill: currentColor;
    margin-right: 0.5rem;
    vertical-align: middle;
  }
  
  .entry__error {
    color: hsl(var(--er));
    font-size: 0.875rem;
    margin-top: 0.25rem;
  }
  
  .sib-form-block__button-with-loader {
    position: relative;
  }
  
  .sib-hide-loader-icon {
    display: none;
  }
  
  .sib-form-block__button-with-loader.loading .sib-hide-loader-icon {
    display: inline-block;
    width: 1rem;
    height: 1rem;
    margin-right: 0.5rem;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
</style>

<script is:inline>
  // @ts-ignore
  window.REQUIRED_CODE_ERROR_MESSAGE = 'Veuillez choisir un code pays';
  // @ts-ignore
  window.LOCALE = 'fr';
  // @ts-ignore
  window.EMAIL_INVALID_MESSAGE = window.SMS_INVALID_MESSAGE = "Les informations que vous avez fournies ne sont pas valides. Veuillez vérifier le format du champ et réessayer.";
  // @ts-ignore
  window.REQUIRED_ERROR_MESSAGE = "Vous devez renseigner ce champ. ";
  // @ts-ignore
  window.GENERIC_INVALID_MESSAGE = "Les informations que vous avez fournies ne sont pas valides. Veuillez vérifier le format du champ et réessayer.";
  // @ts-ignore
  window.translation = {
    common: {
      selectedList: '{quantity} liste sélectionnée',
      selectedLists: '{quantity} listes sélectionnées',
      selectedOption: '{quantity} sélectionné',
      selectedOptions: '{quantity} sélectionnés',
    }
  };
  // @ts-ignore
  window.AUTOHIDE = Boolean(0);
</script>
<script is:inline defer src="https://sibforms.com/forms/end-form/build/main.js"></script>